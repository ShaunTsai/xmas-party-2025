<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSVP è¡¨å–®æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #C41E3A;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #a01628;
        }
        .log {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .info { color: #00bfff; }
        h2 { color: #C41E3A; }
    </style>
</head>
<body>
    <h1>ğŸ„ RSVP è¡¨å–®é™¤éŒ¯å·¥å…·</h1>

    <!-- Test 1: Direct URL Test -->
    <div class="test-section">
        <h2>æ¸¬è©¦ 1: ç›´æ¥æ¸¬è©¦ Apps Script URL</h2>
        <p>é€™æœƒç›´æ¥å‘¼å«ä½ çš„ Google Apps Script</p>
        <button onclick="testDirectURL()">ğŸ”— æ¸¬è©¦ URL</button>
        <div id="log1" class="log"></div>
    </div>

    <!-- Test 2: Fetch Test -->
    <div class="test-section">
        <h2>æ¸¬è©¦ 2: Fetch API æ¸¬è©¦</h2>
        <p>æ¨¡æ“¬å‰ç«¯è¡¨å–®æäº¤</p>
        <button onclick="testFetch()">ğŸ“¤ æ¸¬è©¦ Fetch</button>
        <div id="log2" class="log"></div>
    </div>

    <!-- Test 3: Form Data Test -->
    <div class="test-section">
        <h2>æ¸¬è©¦ 3: å®Œæ•´è¡¨å–®è³‡æ–™æ¸¬è©¦</h2>
        <p>ä½¿ç”¨å®Œæ•´çš„è¡¨å–®è³‡æ–™</p>
        <button onclick="testFullForm()">ğŸ“ æ¸¬è©¦å®Œæ•´è¡¨å–®</button>
        <div id="log3" class="log"></div>
    </div>

    <!-- Test 4: Check Sheet -->
    <div class="test-section">
        <h2>æ¸¬è©¦ 4: æª¢æŸ¥æ¸…å–®</h2>
        <div style="line-height: 2;">
            <label><input type="checkbox"> Apps Script å·²éƒ¨ç½²ï¼ˆåŸ·è¡Œèº«åˆ†ï¼šæˆ‘ï¼Œå­˜å–æ¬Šé™ï¼šä»»ä½•äººï¼‰</label><br>
            <label><input type="checkbox"> Google Sheet æœ‰æ­£ç¢ºçš„æ¬„ä½æ¨™é¡Œ</label><br>
            <label><input type="checkbox"> URL ä»¥ /exec çµå°¾ï¼ˆä¸æ˜¯ /devï¼‰</label><br>
            <label><input type="checkbox"> åœ¨ Apps Script ä¸­åŸ·è¡Œé testScript() å‡½æ•¸</label><br>
            <label><input type="checkbox"> ç€è¦½å™¨ Console æ²’æœ‰éŒ¯èª¤ï¼ˆF12ï¼‰</label><br>
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyw-_KlOuFPASNsGBe34P2gxoaqkWawNPfkvnpOPOj9oVmpynJOhd04ixcZGSMEZM8hIw/exec';

        function log(elementId, message, type = 'info') {
            const logEl = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            logEl.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            logEl.scrollTop = logEl.scrollHeight;
        }

        function clearLog(elementId) {
            document.getElementById(elementId).innerHTML = '';
        }

        async function testDirectURL() {
            clearLog('log1');
            log('log1', 'ğŸ”— æ¸¬è©¦é–‹å§‹...', 'info');
            log('log1', `URL: ${SCRIPT_URL}`, 'info');
            
            const testURL = `${SCRIPT_URL}?name=æ¸¬è©¦ç”¨æˆ¶&invitedBy=Shaun&attendance=yes`;
            log('log1', `å®Œæ•´ URL: ${testURL}`, 'info');
            
            try {
                log('log1', 'ğŸ“¤ ç™¼é€è«‹æ±‚...', 'info');
                const response = await fetch(testURL, {
                    method: 'GET',
                    redirect: 'follow'
                });
                
                log('log1', `âœ… è«‹æ±‚å®Œæˆï¼Status: ${response.status}`, 'success');
                log('log1', `Response type: ${response.type}`, 'info');
                log('log1', 'ğŸ’¡ è«‹æª¢æŸ¥ Google Sheet æ˜¯å¦æœ‰æ–°è³‡æ–™ï¼', 'success');
                
            } catch (error) {
                log('log1', `âŒ éŒ¯èª¤: ${error.message}`, 'error');
                log('log1', `éŒ¯èª¤è©³æƒ…: ${JSON.stringify(error)}`, 'error');
            }
        }

        async function testFetch() {
            clearLog('log2');
            log('log2', 'ğŸ“¤ Fetch æ¸¬è©¦é–‹å§‹...', 'info');
            
            const params = new URLSearchParams({
                name: 'æ¸¬è©¦ç”¨æˆ¶',
                invitedBy: 'Shaun',
                email: 'test@example.com',
                attendance: 'yes',
                arrivalTime: '14:00',
                departureTime: '18:00',
                dietaryRestrictions: 'ç´ é£Ÿ',
                plusOne: 'no',
                plusOneName: '',
                notes: 'é€™æ˜¯æ¸¬è©¦'
            });
            
            const fullURL = `${SCRIPT_URL}?${params.toString()}`;
            log('log2', `URL é•·åº¦: ${fullURL.length} å­—å…ƒ`, 'info');
            
            try {
                const response = await fetch(fullURL, {
                    method: 'GET',
                    redirect: 'follow'
                });
                
                log('log2', `âœ… æˆåŠŸï¼Status: ${response.status}`, 'success');
                log('log2', 'ğŸ’¡ è«‹æª¢æŸ¥ Google Sheetï¼', 'success');
                
            } catch (error) {
                log('log2', `âŒ éŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        async function testFullForm() {
            clearLog('log3');
            log('log3', 'ğŸ“ å®Œæ•´è¡¨å–®æ¸¬è©¦...', 'info');
            
            const formData = {
                name: 'ç‹å°æ˜',
                invitedBy: 'Joshua',
                email: 'test@gmail.com',
                attendance: 'yes',
                arrivalTime: '15:30',
                departureTime: '20:00',
                dietaryRestrictions: 'ä¸åƒç‰›è‚‰',
                plusOne: 'yes',
                plusOneName: 'æå°è¯',
                notes: 'æœƒå¸¶æ¡ŒéŠä¾†ï¼'
            };
            
            log('log3', `è¡¨å–®è³‡æ–™: ${JSON.stringify(formData, null, 2)}`, 'info');
            
            const params = new URLSearchParams(formData);
            const fullURL = `${SCRIPT_URL}?${params.toString()}`;
            
            try {
                const response = await fetch(fullURL, {
                    method: 'GET',
                    redirect: 'follow'
                });
                
                log('log3', `âœ… æäº¤æˆåŠŸï¼`, 'success');
                log('log3', `Status: ${response.status}`, 'info');
                log('log3', 'ğŸ’¡ è«‹åˆ° Google Sheet ç¢ºèªè³‡æ–™ï¼', 'success');
                
            } catch (error) {
                log('log3', `âŒ éŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        // Auto-run first test on load
        window.addEventListener('load', () => {
            log('log1', 'ğŸ‘‹ é é¢è¼‰å…¥å®Œæˆï¼Œæº–å‚™æ¸¬è©¦...', 'info');
        });
    </script>
</body>
</html>
